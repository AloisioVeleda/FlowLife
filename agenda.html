<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FlowLife ‚Äî Agenda Semanal Inteligente</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">


  <script src="firebase-init.js" defer></script>
  <script src="auth-guard.js" defer></script>

  <style>
    /* -------------------------------------- */
    /* 1. Anima√ß√µes e Resets */
    /* -------------------------------------- */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* -------------------------------------- */
    /* 2. Estilos Globais e Body */
    /* -------------------------------------- */
    body {
      font-family: 'Poppins', sans-serif;
      background: #0f1115;
      color: #f5f5f5;
      overflow-x: hidden;
    }

    :root {
      --scroll-behavior: smooth;
    }

     /* =======================================================
       üåø GLOBAL & VARI√ÅVEIS
       ======================================================= */
    :root {
      --scroll-behavior: smooth;
      --accent-green: #4caf50;
      --accent-blue: #2196F3;
      --bg-primary: #0f1115;
      --bg-secondary: #1c2026;
      --bg-tertiary: #252a31;
      --text-primary: #f5f5f5;
      --text-secondary: #bdbdbd;
      --nav-height: 70px; /* Altura padr√£o da navega√ß√£o */
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: var(--scroll-behavior); }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      overflow-x: hidden;
    }
    a { text-decoration: none; color: inherit; }

    /* =======================================================
       üß≠ NAVEGA√á√ÉO (PADR√ÉO PARA TODAS AS P√ÅGINAS)
       ======================================================= */
    nav {
      position: fixed; top: 0; left: 0; width: 100%; height: var(--nav-height);
      backdrop-filter: blur(10px); background: rgba(15, 17, 21, 0.85);
      box-shadow: 0 1px 8px rgba(0, 0, 0, 0.3); z-index: 100;
    }
    .nav-container {
      max-width: 1200px; margin: auto; height: 100%;
      display: flex; justify-content: space-between; align-items: center;
      padding: 0 2rem;
    }
    .nav-logo {
      font-size: 1.5rem; font-weight: 700; color: var(--accent-green);
      letter-spacing: 1px; display: flex; align-items: center; gap: 8px;
    }
    .nav-menu { display: flex; gap: 1.5rem; }
    .nav-menu a {
      color: #e0e0e0; font-size: 0.95rem; font-weight: 500;
      position: relative; transition: color 0.3s ease;
    }
    .nav-menu a::after {
      content: ""; position: absolute; width: 0%; height: 2px;
      bottom: -4px; left: 0; background-color: var(--accent-green);
      transition: width 0.3s;
    }
    .nav-menu a:hover, .nav-menu a.active { color: var(--accent-green); }
    .nav-menu a:hover::after, .nav-menu a.active::after { width: 100%; }

    /* =======================================================
       ‚ú® HERO SECTION (ESPEC√çFICO DA HOME)
       ======================================================= */
    .hero {
      min-height: 100vh; display: flex; flex-direction: column;
      justify-content: center; align-items: center; text-align: center;
      padding: 0 2rem; position: relative; overflow: hidden;
      /* Compensa√ß√£o para o conte√∫do n√£o ficar atr√°s da nav */
      padding-top: var(--nav-height); 
    }
    .hero-bg-glow {
      position: absolute; width: 600px; height: 600px;
      background: var(--accent-green); filter: blur(200px);
      opacity: 0.15; top: -20%; right: -10%; z-index: -1;
      animation: pulse 8s ease-in-out infinite alternate;
    }
    .hero-title {
  font-size: clamp(2.5rem, 6vw, 4rem);
  font-weight: 700;
  line-height: 1.1;
  margin-bottom: 1.5rem;
  max-width: 900px;
  background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
  background-clip: text;            /* Adicionado */
  -webkit-background-clip: text;
  color: transparent;               /* Melhor que -webkit-text-fill-color para maior compatibilidade */
  animation: fadeUp 1s ease forwards;
}

    .hero-subtitle {
      font-size: 1.2rem; color: var(--text-secondary);
      max-width: 700px; margin-bottom: 2.5rem; min-height: 3rem; /* Reserva espa√ßo para digita√ß√£o */
      animation: fadeUp 1s ease 0.3s forwards; opacity: 0;
    }
    .hero-btn {
      padding: 1rem 3rem; font-size: 1.1rem; font-weight: 600;
      border: none; border-radius: 50px; cursor: pointer;
      background: linear-gradient(90deg, var(--accent-green), #66bb6a);
      color: #fff; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      transition: transform 0.2s, box-shadow 0.2s;
      animation: fadeUp 1s ease 0.6s forwards; opacity: 0;
    }
    .hero-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 25px rgba(76, 175, 80, 0.5); }

    /* -------------------------------------- */
    /* 4. Cabe√ßalho (Header) */
    /* -------------------------------------- */
    header {
      text-align: center;
      padding: 28px 12px;
      animation: fadeIn 0.5s ease-out;
      /* padding top repetido no body: <br><br><br> */
    }

    header p {
      color: #bdbdbd;
    }

    /* -------------------------------------- */
    /* 5. Layout do Calend√°rio e Dia */
    /* -------------------------------------- */
    .calendar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 20px;
      margin: 0 auto;
      padding: 0 20px;
      max-width: 1400px;
      animation: fadeIn 0.7s ease-out;
    }

    .day {
      background: #1c2026;
      padding: 16px;
      border-radius: 16px;
      box-shadow: 0 8px 35px rgba(0, 0, 0, 0.4);
      display: flex;
      flex-direction: column;
    }

    .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      color: #e0e0e0;
    }

    .quick-add-btn {
      background: #333;
      color: #fff;
      border: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 28px;
      transition: background 0.2s, transform 0.2s;
    }

    .quick-add-btn:hover {
      background: #4caf50;
      transform: scale(1.1);
    }

    .day ul {
      list-style: none;
      padding: 0;
      flex-grow: 1;
    }

    /* -------------------------------------- */
    /* 6. Item de Tarefa (Task Item) */
    /* -------------------------------------- */
    .task-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      padding: 12px;
      border-radius: 10px;
      background: #252a31;
      border-left: 4px solid transparent;
      transition: all 0.3s ease;
      animation: fadeIn 0.4s;
    }

    .task-item.completed {
      background: rgba(76, 175, 80, 0.15);
      opacity: 0.6;
    }

    .task-item.completed .task-details span {
      text-decoration: line-through;
      color: #a5d6a7;
    }

    .task-details {
      display: flex;
      flex-direction: column;
    }

    .task-details .time {
      font-size: 0.8rem;
      color: #aaa;
    }

    /* Cores por Categoria */
    .task-item[data-category="saude"] {
      border-left-color: #4caf50;
    }

    .task-item[data-category="financas"] {
      border-left-color: #2196F3;
    }

    .task-item[data-category="organizacao"] {
      border-left-color: #FFC107;
    }

    /* A√ß√µes da Tarefa */
    .task-actions button {
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
      margin-left: 5px;
    }

    .task-actions svg {
      width: 18px;
      height: 18px;
      transition: transform 0.2s;
    }

    .task-actions button:hover svg {
      transform: scale(1.2);
    }

    /* -------------------------------------- */
    /* 7. Estado Vazio (Empty State) */
    /* -------------------------------------- */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      margin: 20px;
      background: #1c2026;
      border-radius: 16px;
      animation: fadeIn 0.5s;
    }

    .empty-state h3 {
      margin-bottom: 10px;
    }

    .empty-state p {
      color: #bdbdbd;
      margin-bottom: 20px;
    }

    .empty-state button {
      background: #4caf50;
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
      transition: transform 0.2s;
    }

    .empty-state button:hover {
      transform: scale(1.05);
    }

    /* -------------------------------------- */
    /* 8. A√ß√µes Globais */
    /* -------------------------------------- */
    .global-actions {
      text-align: center;
      margin: 28px 0;
      animation: fadeIn 0.9s ease-out;
    }

    .global-actions button {
      background: #777;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
    }

    .global-actions button:hover {
      background: #666;
    }

    /* -------------------------------------- */
    /* 9. Modal de Tarefa (Task Modal) */
    /* -------------------------------------- */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }

    .modal.visible {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: #1c2026;
      padding: 24px;
      border-radius: 16px;
      width: 90%;
      max-width: 400px;
      text-align: center;
      transform: scale(0.95);
      transition: transform 0.3s;
    }

    .modal.visible .modal-content {
      transform: scale(1);
    }

    .modal-content label {
      display: block;
      margin: 12px 0 6px;
      text-align: left;
      color: #bdbdbd;
    }

    .modal-content input,
    .modal-content select {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #252a31;
      color: #f5f5f5;
      font-size: 1rem;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      margin-top: 16px;
    }

    .modal-actions button {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      transition: background 0.2s;
    }

    .modal-actions .primary {
      background: #4caf50;
      color: #fff;
    }

    .modal-actions .primary:hover {
      background: #43a047;
    }

    .modal-actions .secondary {
      background: #333;
      color: #e0e0e0;
    }

    .modal-actions .secondary:hover {
      background: #444;
    }

    /* -------------------------------------- */
    /* 10. Rodap√© (Footer) */
    /* -------------------------------------- */
    footer {
      text-align: center;
      padding: 20px 0;
      font-size: 0.9rem;
      color: #777;
    }
  </style>
</head>

<body>
  <br><br><br>

  <!-- NAV PADRONIZADA -->
  <nav>
    <div class="nav-container">
      <a href="index.html" class="nav-logo">
        <i class="fas fa-leaf"></i> FlowLife
      </a>
      <div class="nav-menu">
        <!-- Links internos do app -->
        <a href="dashboard.html">Dashboard</a>
        <a href="agenda.html">Agenda</a>
        <a href="financas.html">Finan√ßas</a>
        <a href="nutricao.html">Nutri√ß√£o</a>
        <!-- Perfil por √∫ltimo -->
        <a href="perfil.html"><i class="far fa-user-circle"></i> Perfil</a>
      </div>
    </div>
  </nav>

  <header>
    <h1>üóìÔ∏è Agenda Semanal Inteligente</h1>
    <p>Organize suas tarefas e construa uma rotina equilibrada.</p>
  </header>

  <main>
    <div id="calendar-container">
      <div class="calendar">
        <div class="day" id="monday">
          <div class="day-header">
            <h2>Segunda</h2><button class="quick-add-btn" data-day="monday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="tuesday">
          <div class="day-header">
            <h2>Ter√ßa</h2><button class="quick-add-btn" data-day="tuesday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="wednesday">
          <div class="day-header">
            <h2>Quarta</h2><button class="quick-add-btn" data-day="wednesday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="thursday">
          <div class="day-header">
            <h2>Quinta</h2><button class="quick-add-btn" data-day="thursday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="friday">
          <div class="day-header">
            <h2>Sexta</h2><button class="quick-add-btn" data-day="friday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="saturday">
          <div class="day-header">
            <h2>S√°bado</h2><button class="quick-add-btn" data-day="saturday">+</button>
          </div>
          <ul></ul>
        </div>
        <div class="day" id="sunday">
          <div class="day-header">
            <h2>Domingo</h2><button class="quick-add-btn" data-day="sunday">+</button>
          </div>
          <ul></ul>
        </div>
      </div>
    </div>

    <div id="empty-state-container" class="hidden">
      <div class="empty-state">
        <h3>Sua semana parece tranquila üòå</h3>
        <p>Adicione tarefas para planejar seus dias.</p>
        <button id="addFirstTaskBtn">‚ú® Criar Primeira Tarefa</button>
      </div>
    </div>

    <div class="global-actions">
      <button id="resetBtn">üßπ Limpar Toda a Agenda</button>
    </div>
  </main>

  <div id="taskModal" class="modal">
    <div class="modal-content">
      <h3 id="modalTitle">Nova Tarefa</h3>
      <label for="daySelect">Dia da semana:</label>
      <select id="daySelect"></select>
      <label for="taskInput">Nome da tarefa:</label>
      <input type="text" id="taskInput" placeholder="Ex: Caminhada matinal" />
      <label for="timeInput">Hor√°rio:</label>
      <input type="time" id="timeInput" required />
      <label for="categorySelect">Categoria:</label>
      <select id="categorySelect">
        <option value="organizacao">üß† Organiza√ß√£o</option>
        <option value="saude">üí™ Sa√∫de</option>
        <option value="financas">üí∞ Finan√ßas</option>
      </select>
      <div class="modal-actions">
        <button id="addTaskBtn" class="primary">Adicionar</button>
        <button id="closeModalBtn" class="secondary">Cancelar</button>
      </div>
    </div>
  </div>

  <footer>¬© <span id="year"></span> FlowLife</footer>

  <script>
    /* -------------------------------------- */
    /* 1. Inicializa√ß√£o e Vari√°veis Globais */
    /* -------------------------------------- */
    document.addEventListener('DOMContentLoaded', () => {
      const TASKS_KEY = 'flowlife_weeklyTasks';
      const savedTasks = JSON.parse(localStorage.getItem(TASKS_KEY)) || {};

      const dom = {
        year: document.getElementById('year'),
        calendarContainer: document.getElementById('calendar-container'),
        emptyStateContainer: document.getElementById('empty-state-container'),
        modal: document.getElementById('taskModal'),
        daySelect: document.getElementById('daySelect'),
        taskInput: document.getElementById('taskInput'),
        timeInput: document.getElementById('timeInput'),
        categorySelect: document.getElementById('categorySelect'),
        addTaskBtn: document.getElementById('addTaskBtn'),
        closeModalBtn: document.getElementById('closeModalBtn'),
        resetBtn: document.getElementById('resetBtn'),
        addFirstTaskBtn: document.getElementById('addFirstTaskBtn'),
        quickAddBtns: document.querySelectorAll('.quick-add-btn')
      };

      const weekDays = {
        monday: "Segunda-feira", tuesday: "Ter√ßa-feira", wednesday: "Quarta-feira",
        thursday: "Quinta-feira", friday: "Sexta-feira", saturday: "S√°bado", sunday: "Domingo"
      };

      /* -------------------------------------- */
      /* 2. Fun√ß√µes de Manipula√ß√£o de Dados */
      /* -------------------------------------- */

      // Salva as tarefas no LocalStorage e re-renderiza
      const saveTasks = () => {
        localStorage.setItem(TASKS_KEY, JSON.stringify(savedTasks));
        renderAllTasks();
      };

      // Atualiza a visibilidade do calend√°rio e do estado vazio
      const updateUI = () => {
        const hasTasks = Object.keys(savedTasks).length > 0;
        dom.calendarContainer.classList.toggle('hidden', !hasTasks);
        dom.emptyStateContainer.classList.toggle('hidden', hasTasks);
      };

      // Cria um elemento de lista (<li>) para uma tarefa
      const createTaskElement = (key, taskData) => {
        const [dayId, taskName, time] = key.split('_');
        const li = document.createElement('li');
        li.className = 'task-item';
        li.dataset.key = key;
        li.dataset.category = taskData.category;
        if (taskData.completed) li.classList.add('completed');

        li.innerHTML = `
          <div class="task-details">
            <span>${taskName}</span>
            <span class="time">${time}</span>
          </div>
          <div class="task-actions">
            <button class="done-btn" title="Concluir">
              <svg fill="#4caf50" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>
            </button>
            <button class="delete-btn" title="Excluir">
              <svg fill="#e53935" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
            </button>
          </div>`;

        // Listeners para Concluir/Deletar
        li.querySelector('.done-btn').addEventListener('click', () => {
          savedTasks[key].completed = !savedTasks[key].completed;
          saveTasks();
        });

        li.querySelector('.delete-btn').addEventListener('click', () => {
          delete savedTasks[key];
          saveTasks();
        });

        return li;
      };

      // Renderiza todas as tarefas em todos os dias, ordenando por hora
      const renderAllTasks = () => {
        // Limpa os Uls existentes
        document.querySelectorAll('.day ul').forEach(ul => ul.innerHTML = '');

        // Ordena as tarefas pelo hor√°rio (parte [2] da chave: day_name_time)
        const sortedTasks = Object.entries(savedTasks).sort((a, b) => a[0].split('_')[2].localeCompare(b[0].split('_')[2]));

        // Adiciona cada tarefa ao seu respectivo dia
        for (const [key, data] of sortedTasks) {
          const dayId = key.split('_')[0];
          const ul = document.getElementById(dayId)?.querySelector('ul');
          if (ul) ul.appendChild(createTaskElement(key, data));
        }
        updateUI(); // Chama a atualiza√ß√£o da UI ap√≥s a renderiza√ß√£o
      };

      // Adiciona uma nova tarefa ao objeto savedTasks
      const addTask = () => {
        const dayId = dom.daySelect.value;
        const taskName = dom.taskInput.value.trim();
        const time = dom.timeInput.value;
        const category = dom.categorySelect.value;

        if (!taskName || !time) return alert('Preencha nome e hor√°rio.');

        const key = `${dayId}_${taskName}_${time}`;
        if (savedTasks[key]) return alert('Essa tarefa j√° existe.');

        savedTasks[key] = { completed: false, category };
        saveTasks();
        closeModal();
      };

      /* -------------------------------------- */
      /* 3. Fun√ß√µes de Modal e UI */
      /* -------------------------------------- */

      // Preenche o <select> de dias da semana no modal
      const populateDaySelect = () => {
        dom.daySelect.innerHTML = Object.entries(weekDays).map(([value, text]) => `<option value="${value}">${text}</option>`).join('');
      };

      // Abre o modal, opcionalmente pr√©-selecionando um dia
      const openModal = (day = 'monday') => {
        dom.modal.classList.add('visible');
        dom.taskInput.value = '';
        dom.timeInput.value = '';
        dom.daySelect.value = day;
      };

      // Fecha o modal
      const closeModal = () => dom.modal.classList.remove('visible');

      /* -------------------------------------- */
      /* 4. Listeners e Inicializa√ß√£o */
      /* -------------------------------------- */
      const setupListeners = () => {
        // Modal
        dom.addTaskBtn.addEventListener('click', addTask);
        dom.closeModalBtn.addEventListener('click', closeModal);
        dom.addFirstTaskBtn.addEventListener('click', () => openModal('monday'));

        // Bot√µes de Adi√ß√£o R√°pida
        dom.quickAddBtns.forEach(btn => btn.addEventListener('click', () => openModal(btn.dataset.day)));

        // A√ß√£o de Limpar Agenda
        dom.resetBtn.addEventListener('click', () => {
          if (confirm('Deseja limpar toda a agenda?')) {
            for (let key in savedTasks) delete savedTasks[key];
            saveTasks();
          }
        });

        // Fechar com ESC
        window.addEventListener('keydown', e => e.key === 'Escape' && closeModal());
      };

      // Inicia a aplica√ß√£o
      const init = () => {
        dom.year.textContent = new Date().getFullYear();
        populateDaySelect();
        renderAllTasks();
        setupListeners();
      };

      // Execu√ß√£o da Inicializa√ß√£o
      init();
    });
  </script>
</body>

</html>